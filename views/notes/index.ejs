<%- include('../partials/header') %>
<body>
  <script type="importmap">
    {
      "imports": {
        "three": "../../build/three.module.js",
        "three/examples/jsm/loaders/GLTFLoader": "../../jsm/loaders/GLTFLoader.js",
        "three/examples/jsm/controls/OrbitControls": "../../jsm/controls/OrbitControls.js",
        "three/examples/jsm/libs/stats.module": "../../jsm/libs/stats.module.js",
        "lil-gui": "../dist/lil-gui.esm.js"
      }
    }
  </script>
 <script id="helper" data-name='<%= objectPath %>'  src="../../javascripts/discoverShow.js"></script>
    <script type="module" src="../../javascripts/discoverShow.js"></script>
    <link rel='stylesheet' href='/stylesheets/style.css' />

    <div class="show_container">

<div id="furniture_details" >
    <div id="product_name"><%= furnitureData.product_name %></div>
</div>
</div>

<% if (furnitureData.notes.length) { %>
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Note</th>
      </tr>
    </thead>
    <tbody>
        <% furnitureData.notes.forEach(function(n) { %>
            <tr>
              <td>
                <%= n.createdAt.toLocaleDateString() %>
              </td>
              <td>
                <form id="edit_note" action="/notes/<%=n._id%>?_method=PUT" method="POST">
                  <textarea type="text" name="content"><%= n.content %></textarea>
                  <input  type="submit" value="Edit Private Note">
                </form>
              </td>
              <td>
                <% if (user && user._id.equals(n.user)) { %>
                  <form action="/notes/<%= n._id %>?_method=DELETE" method="POST">
                    <button type="submit">X</button>
                  </form>
                <% } %>
              </td>
            </tr> 
            <% }); %> 
              
    </tbody>
  </table>
  <% } else { %>
    <h5>No Private Notes Yet</h5>
    <% } %>


<% if (user) { %>
    <div class="review_container">
    <form id="add_note" method="POST" action="/notes/<%= furnitureData._id %>">
      <label>Note:</label>
      <textarea type="text" name="content"> </textarea>
      <input  type="submit" value="Add Private Note">
    </form>
    </div>
<% } %>
